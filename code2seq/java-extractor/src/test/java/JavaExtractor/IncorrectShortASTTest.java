package JavaExtractor;

import java.io.ByteArrayOutputStream;
import java.io.PrintStream;

import static org.junit.jupiter.api.Assertions.*;

class IncorrectShortASTTest {
    @org.junit.jupiter.api.Test
    void main() {
        // Create a stream to hold the output
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        PrintStream ps = new PrintStream(baos);
        PrintStream old = System.out;
        System.setOut(ps);

        String[] args = {"--code2seq", "true", "--max_path_length", "8", "--max_path_width", "2", "--file", "src/test/resources/LongJavaFileForAST.java", "--off_by_one", "true"};
        App.main(args);

        System.out.flush();
        System.setOut(old);
        String result = baos.toString();

        assertNotEquals("", baos.toString().split("\\n")[0].trim());
        assertFalse(result.contains("bug public,713892080,METHOD_NAME public,950167328,void METHOD_NAME,-1051653051,void METHOD_NAME,-233248961,string METHOD_NAME,1438496582,a METHOD_NAME,2070746553,a METHOD_NAME,-46419787,a METHOD_NAME,1080690402,null METHOD_NAME,-1965427729,out METHOD_NAME,680169776,println METHOD_NAME,-33742705,asdfasd METHOD_NAME,-142652288,5 METHOD_NAME,-142652257,10 METHOD_NAME,-1965427729,out METHOD_NAME,680169776,println METHOD_NAME,-33742705,bee void,498829263,string void,1161853110,a void,-1425877431,a void,574196261,a void,157529170,null void,-2122519425,out void,601735840,println void,-1151045345,asdfasd void,671400432,5 void,671400463,10 void,-2122519425,out void,601735840,println void,-1151045345,bee string,-1874857689,a string,982592696,a string,1116924770,null string,966914304,5 string,966914335,10 a,250754796,a a,2056522089,a a,1515189910,null a,-927055308,5 a,-927055277,10 a,2110223822,a a,1913770683,null a,909870041,5 a,909870072,10 a,-311493177,null a,-1864988675,out a,1579600866,println a,-1080239715,asdfasd a,-741056001,5 a,-741055970,10 null,1907805228,system null,1353511473,out null,-285882834,println null,129626577,asdfasd null,468810291,5 null,468810322,10 null,60115363,println null,102404284,bee system,-1644303265,out system,-445258808,println system,-1060883721,asdfasd out,1037919652,println out,865870235,asdfasd println,-1909290285,asdfasd println,-491441099,5 println,-491441068,10 asdfasd,-406219536,5 asdfasd,-406219505,10 5,748445662,10 5,-1152511886,system 5,372612523,out 5,855222516,println 5,-333675445,bee 10,777718963,system 10,-1941192694,out 10,1655758069,println 10,360971562,bee system,-1644303265,out system,-445258808,println system,-1060883721,bee out,1037919652,println out,865870235,bee println,-1909290285,bee"));
        assertFalse(result.contains("bug public,Mdfr0|Mth|SmplNm1,METHOD_NAME public,Mdfr0|Mth|Void2,void METHOD_NAME,SmplNm1|Mth|Void2,void METHOD_NAME,SmplNm1|Mth|Bk|Ex|VDE|VD|Cls|SmplNm0,string METHOD_NAME,SmplNm1|Mth|Bk|Ex|VDE|VD|SmplNm1,a METHOD_NAME,SmplNm1|Mth|Bk|Ex|VDE|VD|StrEx2,a METHOD_NAME,SmplNm1|Mth|Bk|If|Neq|Nm|SmplNm0,a METHOD_NAME,SmplNm1|Mth|Bk|If|Neq|Null1,null METHOD_NAME,SmplNm1|Mth|Bk|If|Bk|Ex|Cal0|Fld0|SmplNm1,out METHOD_NAME,SmplNm1|Mth|Bk|If|Bk|Ex|Cal0|SmplNm1,println METHOD_NAME,SmplNm1|Mth|Bk|If|Bk|Ex|Cal0|StrEx2,asdfasd METHOD_NAME,SmplNm1|Mth|Bk|If|Leq|IntEx0,5 METHOD_NAME,SmplNm1|Mth|Bk|If|Leq|IntEx1,10 METHOD_NAME,SmplNm1|Mth|Bk|If|Bk|Ex|Cal0|Fld0|SmplNm1,out METHOD_NAME,SmplNm1|Mth|Bk|If|Bk|Ex|Cal0|SmplNm1,println METHOD_NAME,SmplNm1|Mth|Bk|If|Bk|Ex|Cal0|StrEx2,bee void,Void2|Mth|Bk|Ex|VDE|VD|Cls|SmplNm0,string void,Void2|Mth|Bk|Ex|VDE|VD|SmplNm1,a void,Void2|Mth|Bk|Ex|VDE|VD|StrEx2,a void,Void2|Mth|Bk|If|Neq|Nm|SmplNm0,a void,Void2|Mth|Bk|If|Neq|Null1,null void,Void2|Mth|Bk|If|Bk|Ex|Cal0|Fld0|SmplNm1,out void,Void2|Mth|Bk|If|Bk|Ex|Cal0|SmplNm1,println void,Void2|Mth|Bk|If|Bk|Ex|Cal0|StrEx2,asdfasd void,Void2|Mth|Bk|If|Leq|IntEx0,5 void,Void2|Mth|Bk|If|Leq|IntEx1,10 void,Void2|Mth|Bk|If|Bk|Ex|Cal0|Fld0|SmplNm1,out void,Void2|Mth|Bk|If|Bk|Ex|Cal0|SmplNm1,println void,Void2|Mth|Bk|If|Bk|Ex|Cal0|StrEx2,bee string,SmplNm0|Cls|VD|SmplNm1,a string,SmplNm0|Cls|VD|StrEx2,a string,SmplNm0|Cls|VD|VDE|Ex|Bk|If|Neq|Null1,null string,SmplNm0|Cls|VD|VDE|Ex|Bk|If|Leq|IntEx0,5 string,SmplNm0|Cls|VD|VDE|Ex|Bk|If|Leq|IntEx1,10 a,SmplNm1|VD|StrEx2,a a,SmplNm1|VD|VDE|Ex|Bk|If|Neq|Nm|SmplNm0,a a,SmplNm1|VD|VDE|Ex|Bk|If|Neq|Null1,null a,SmplNm1|VD|VDE|Ex|Bk|If|Leq|IntEx0,5 a,SmplNm1|VD|VDE|Ex|Bk|If|Leq|IntEx1,10 a,StrEx2|VD|VDE|Ex|Bk|If|Neq|Nm|SmplNm0,a a,StrEx2|VD|VDE|Ex|Bk|If|Neq|Null1,null a,StrEx2|VD|VDE|Ex|Bk|If|Leq|IntEx0,5 a,StrEx2|VD|VDE|Ex|Bk|If|Leq|IntEx1,10 a,SmplNm0|Nm|Neq|Null1,null a,SmplNm0|Nm|Neq|If|Bk|Ex|Cal0|Fld0|SmplNm1,out a,SmplNm0|Nm|Neq|If|Bk|Ex|Cal0|SmplNm1,println a,SmplNm0|Nm|Neq|If|Bk|Ex|Cal0|StrEx2,asdfasd a,SmplNm0|Nm|Neq|If|Bk|If|Leq|IntEx0,5 a,SmplNm0|Nm|Neq|If|Bk|If|Leq|IntEx1,10 null,Null1|Neq|If|Bk|Ex|Cal0|Fld0|Nm|SmplNm0,system null,Null1|Neq|If|Bk|Ex|Cal0|Fld0|SmplNm1,out null,Null1|Neq|If|Bk|Ex|Cal0|SmplNm1,println null,Null1|Neq|If|Bk|Ex|Cal0|StrEx2,asdfasd null,Null1|Neq|If|Bk|If|Leq|IntEx0,5 null,Null1|Neq|If|Bk|If|Leq|IntEx1,10 null,Null1|Neq|If|Bk|If|Bk|Ex|Cal0|SmplNm1,println null,Null1|Neq|If|Bk|If|Bk|Ex|Cal0|StrEx2,bee system,SmplNm0|Nm0|Fld0|SmplNm1,out system,SmplNm0|Nm0|Fld0|Cal|SmplNm1,println system,SmplNm0|Nm0|Fld0|Cal|StrEx2,asdfasd out,SmplNm1|Fld0|Cal|SmplNm1,println out,SmplNm1|Fld0|Cal|StrEx2,asdfasd println,SmplNm1|Cal|StrEx2,asdfasd println,SmplNm1|Cal|Ex|Bk|If|Bk|If|Leq|IntEx0,5 println,SmplNm1|Cal|Ex|Bk|If|Bk|If|Leq|IntEx1,10 asdfasd,StrEx2|Cal|Ex|Bk|If|Bk|If|Leq|IntEx0,5 asdfasd,StrEx2|Cal|Ex|Bk|If|Bk|If|Leq|IntEx1,10 5,IntEx0|Leq|IntEx1,10 5,IntEx0|Leq|If|Bk|Ex|Cal0|Fld0|Nm|SmplNm0,system 5,IntEx0|Leq|If|Bk|Ex|Cal0|Fld0|SmplNm1,out 5,IntEx0|Leq|If|Bk|Ex|Cal0|SmplNm1,println 5,IntEx0|Leq|If|Bk|Ex|Cal0|StrEx2,bee 10,IntEx1|Leq|If|Bk|Ex|Cal0|Fld0|Nm|SmplNm0,system 10,IntEx1|Leq|If|Bk|Ex|Cal0|Fld0|SmplNm1,out 10,IntEx1|Leq|If|Bk|Ex|Cal0|SmplNm1,println 10,IntEx1|Leq|If|Bk|Ex|Cal0|StrEx2,bee system,SmplNm0|Nm0|Fld0|SmplNm1,out system,SmplNm0|Nm0|Fld0|Cal|SmplNm1,println system,SmplNm0|Nm0|Fld0|Cal|StrEx2,bee out,SmplNm1|Fld0|Cal|SmplNm1,println out,SmplNm1|Fld0|Cal|StrEx2,bee println,SmplNm1|Cal|StrEx2,bee"));
    }
}